---
import type { CollectionEntry } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import FormattedDate from "../components/FormattedDate.astro";
import ShareButtons from "../components/ShareButtons.tsx";
import type { PaginationData } from "../utils/pagination";
import "@fontsource/josefin-sans";

type Props = CollectionEntry<"blog">["data"] & {
	pagination?: PaginationData;
};

const { title, description, pubDate, updatedDate, tags, pagination } = Astro.props;
const currentUrl = Astro.url.href;
---

<BaseLayout title={title} description={description}>
	<article class="prose dark:prose-invert max-w-full">
		<h1 class="text-xl lg:text-2xl">
			{title}
		</h1>
		<div class="mb-12 flex flex-wrap gap-2 items-baseline">
			<div
				class="flex items-center flex-wrap gap-2 font-['Josefin_Sans'] font-light text-xs text-gray-600 dark:text-gray-300"
			>
				<p class="my-0 whitespace-nowrap">
					Publish :{" "}
					<FormattedDate date={pubDate} />
				</p>
				{
					updatedDate && (
						<p class="my-0 whitespace-nowrap">
							Update : <FormattedDate date={updatedDate} />
						</p>
					)
				}
			</div>
			{
				tags && (
					<div class="flex items-center flex-wrap gap-2 font-['Josefin_Sans'] font-light text-xs text-gray-600">
						{tags.map((tag) => (
							<a
								class="inline-block align-bottom px-1 pt-1 rounded-sm text-inherit bg-slate-200 whitespace-nowrap"
								href={`/tags/${tag}`}
							>
								{tag}
							</a>
						))}
					</div>
				)
			}
		</div>
		<slot />
	</article>
	
	<ShareButtons url={currentUrl} title={title} client:load />
	
	{pagination && (
		<nav class="mt-8 pt-8 border-t border-gray-200 dark:border-gray-700" aria-label="記事ナビゲーション">
			<div class="flex justify-between items-center">
				<div class="flex-1">
					{pagination.nextPost && (
						<a 
							href={`/posts/${pagination.nextPost.slug}/`}
							class="group flex flex-col items-start p-4 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"
							aria-label={`前の記事: ${pagination.nextPost.data.title}`}
						>
							<span class="text-sm text-gray-500 dark:text-gray-400 mb-1">← 前の記事</span>
							<span class="text-sm font-medium text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
								{pagination.nextPost.data.title}
							</span>
						</a>
					)}
				</div>
				
				<div class="flex-1 text-right">
					{pagination.previousPost && (
						<a 
							href={`/posts/${pagination.previousPost.slug}/`}
							class="group flex flex-col items-end p-4 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"
							aria-label={`次の記事: ${pagination.previousPost.data.title}`}
						>
							<span class="text-sm text-gray-500 dark:text-gray-400 mb-1">次の記事 →</span>
							<span class="text-sm font-medium text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
								{pagination.previousPost.data.title}
							</span>
						</a>
					)}
				</div>
			</div>
		</nav>
	)}
</BaseLayout>
